<?xml version="1.0" encoding="utf-8" ?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Development using Angular</title>
    <atom:link href="http://vamshi-krishna.com/angular/feed.xml" rel="self" type="application/rss+xml"></atom:link>
    <link>http://vamshi-krishna.com/angular</link>
    <description>Blogs on web development using AngularJS</description>
    <pubDate>Wed, 04 May 2016 17:00:00 -0700</pubDate>
    <generator>Wintersmith - https://github.com/jnordberg/wintersmith</generator>
    <language>en</language>
    <item>
      <title>Service based architecture</title>
      <link>http://vamshi-krishna.com/angular/angular/articles/services/</link>
      <pubDate>Wed, 04 May 2016 17:00:00 -0700</pubDate>
      <guid isPermaLink="true">http://vamshi-krishna.com/angular/angular/articles/services/</guid>
      <author></author>
      <description>&lt;p&gt;AngularJS code resides mostly in the following :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Controllers&lt;/li&gt;
&lt;li&gt;Services&lt;/li&gt;
&lt;li&gt;Directives&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The weightage depends entirely on the architecture. We can write whole app using only Controller or entirely using directives. This blog is about giving maximum weightage to services and using directives/controllers only for view rendering. How it is advantageous and how to overcome the hurdles.&lt;/p&gt;
&lt;p&gt;For the sake of simplicity lets just compare Controller with Service. Controller vs Directive/Component (ng-1.5) is due for another blog.&lt;/p&gt;
&lt;h3 id=&quot;why-no-controller-&quot;&gt;Why no Controller ?&lt;/h3&gt;
&lt;h4 id=&quot;service-is-singleton-controller-is-not&quot;&gt;Service is singleton, Controller is not&lt;/h4&gt;
&lt;p&gt;The story goes like this. Whenever we open a page, the controller required to render the view of the page is instantiated. That means the whole code in Controller is run ( this is important). Before doing that , all the services upon which the controller is dependent are instantiated( same, the whole code in each service is executed). But â€¦ if the service is already instantiated, the instance is just passed (Singleton !). So if we open the same page in the same app 10 times, Service gets instantiated 1 time and controller code gets run all the 10 times . Imagine doing the same HTTP call every time you open the same page for some reason . Thats total waste.&lt;/p&gt;
&lt;h4 id=&quot;service-can-be-injected&quot;&gt;Service can be injected&lt;/h4&gt;
&lt;p&gt;Ok, controller is a loner whom no one cares except for the page its written for. Not fair to expect to be reusable. Still, the more social our code is, the easier it is to maintain and reuse.&lt;/p&gt;
&lt;h4 id=&quot;easy-to-test&quot;&gt;Easy to test&lt;/h4&gt;
&lt;p&gt;Services are simple Javascript functions, so its straight forward to test them. Unlike in controller, where we can test only those that are tied to &lt;code&gt;scope&lt;/code&gt; ( there is a way to overcome this as mentioned &lt;a href=&quot;http://vamshi-krishna.com/angular/articles/test-private/&quot;&gt;here&lt;/a&gt;)&lt;/p&gt;
&lt;h3 id=&quot;how-to-use-service-use-cases-&quot;&gt;How to use service ( use cases)&lt;/h3&gt;
&lt;h4 id=&quot;store-data-cache-if-possible-&quot;&gt;Store data (cache if possible)&lt;/h4&gt;
&lt;p&gt;Let the data be stored entirely in service. Before performing HTTP call check if the data exists in service already and return that. This goes for a full artible on it (coming soon, keep your questions open) .&lt;/p&gt;
&lt;h4 id=&quot;util-services&quot;&gt;Util services&lt;/h4&gt;
&lt;p&gt;Use services to have util functions as much as possible. If the data object contains 10 fields, all of them might not be needed in controller. Sometimes the data needed is fusion of multiple data sources etc., So the flow would be like :&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Controller --&amp;gt; Util Service --&amp;gt; Data Service
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The goal is to make Controller as light as possible. Use it absolutely only for tying view data to model data. Its ideal to have these util services pure functions, which do not store any kind of data.&lt;/p&gt;
&lt;p&gt;This article will be updated with more details. And there are many unanswered questions, need more examples etc., We will be seeing all of them shortly.&lt;/p&gt;
</description>
    </item>
    <item>
      <title>Testing private functions in Angular</title>
      <link>http://vamshi-krishna.com/angular/angular/articles/test-private/</link>
      <pubDate>Wed, 04 May 2016 17:00:00 -0700</pubDate>
      <guid isPermaLink="true">http://vamshi-krishna.com/angular/angular/articles/test-private/</guid>
      <author></author>
      <description>&lt;blockquote&gt;
&lt;p&gt;This is a workaround. There is no framework support.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;tl;dr : &lt;a href=&quot;https://plnkr.co/edit/EGOOTDBUSuPltHDvEEKx?p=preview&quot;&gt;plnkr.co/edit/EGOOTDBUSuPltHDvEEKx&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;AngularJS by default is a very test friendly framework. For someone who is eager to try functional programming, these days I am writing a lot of tiny private functions and I want to test them independently. Ofcourse this is not possible with the current Angular framework. To overcome this problem I tried a work around and this blog is about that.&lt;/p&gt;
&lt;p&gt;Lets start with a simple example:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-js&quot;&gt;angular.module(&lt;span class=&quot;string&quot;&gt;'app'&lt;/span&gt;,[])
  .service(&lt;span class=&quot;string&quot;&gt;'Service1'&lt;/span&gt;,Service1);

&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Service1&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getMessage = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;num1,num2&lt;/span&gt;)&lt;/span&gt;{
    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;'The sum of the numbers is '&lt;/span&gt;+sum(num1,num2);
  };
  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;sum&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;num1, num2&lt;/span&gt;)&lt;/span&gt;{
    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; num1+num2;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I am not interested to test &lt;code&gt;getMessage&lt;/code&gt; . I only want to test &lt;code&gt;sum&lt;/code&gt; as that is where all the logic happening. My unit test file looks like this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-js&quot;&gt;describe(&lt;span class=&quot;string&quot;&gt;'main tests'&lt;/span&gt;,tests);
&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tests&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; service;
  beforeEach(&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'app'&lt;/span&gt;));
  beforeEach(inject(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;Service1&lt;/span&gt;)&lt;/span&gt;{
    service = Service1;
  }));

  it(&lt;span class=&quot;string&quot;&gt;&quot;should return the sum&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
    expect(service.sum(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)).toBe(&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);
  });
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I want to get this working. But it gives error.&lt;/p&gt;
&lt;p&gt;To get this working, I added another service which always gives &lt;code&gt;false&lt;/code&gt; for &lt;code&gt;testEnabled&lt;/code&gt; value. In general case, we never touch it, but we will set it to &lt;code&gt;true&lt;/code&gt; during testing. This way we can convert private functions to public during test and leave them private in general cases.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-js&quot;&gt;angular.module(&lt;span class=&quot;string&quot;&gt;'app'&lt;/span&gt;,[])
  .service(&lt;span class=&quot;string&quot;&gt;'Service1'&lt;/span&gt;,Service1)
  .service(&lt;span class=&quot;string&quot;&gt;'Service2'&lt;/span&gt;,Service2);

&lt;span class=&quot;comment&quot;&gt;//Service2 code&lt;/span&gt;

&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Service1&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getMessage = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;num1,num2&lt;/span&gt;)&lt;/span&gt;{
    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;'The sum of the numbers is '&lt;/span&gt;+sum(num1,num2);
  };
  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;sum&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;num1, num2&lt;/span&gt;)&lt;/span&gt;{
    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; num1+num2;
  }

  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(Service2.testEnabled){
    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.sum = sum;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we can continue with unit tests.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;lang-js&quot;&gt;angular.module(&lt;span class=&quot;string&quot;&gt;'app'&lt;/span&gt;,[])
  .service(&lt;span class=&quot;string&quot;&gt;'Service1'&lt;/span&gt;,Service1)
  .service(&lt;span class=&quot;string&quot;&gt;'Service2'&lt;/span&gt;,Service2);


describe(&lt;span class=&quot;string&quot;&gt;'main tests'&lt;/span&gt;,tests);
&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tests&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; service, service2;
  beforeEach(&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;'app'&lt;/span&gt;));
  beforeEach(inject(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;Service2&lt;/span&gt;)&lt;/span&gt;{
    service2 = Service2;
    service2.enableTest();
  }));
  beforeEach(inject(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;Service1&lt;/span&gt;)&lt;/span&gt;{
    service = Service1;
  }));

  it(&lt;span class=&quot;string&quot;&gt;&quot;should return the name&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;{
    expect(service.sum(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)).toBe(&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);
  });
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Works great !!&lt;/p&gt;
&lt;p&gt;The same can be used for private functions in Controllers too.&lt;/p&gt;
</description>
    </item>
  </channel>
</rss>